function onInitController(e,t){if("iphone"==Ti.Platform.osname)var r=require("TiTools2/TiTools");else var r=require("TiTools2_a/TiTools");win_main=e,storeInfo=t,Map=require("ti.map"),cmp=r.Component,clicked=!1,Ti.Network.online||(offline=!0)}function onWindowOpen(e,t){prepareText=function(e){return e=e.replace(/(\\r\\n|\n|\r|\t)/gm,""),e=e.replace(new RegExp("</td><td>","g"),": "),e=e.replace(new RegExp("&nbsp;","g")," "),e=e.replace(new RegExp("&ndash;","g"),"-"),e=e.replace(new RegExp("&quot;","g"),'"'),e=e.replace(new RegExp("&deg;","g"),"°"),e=e.replace(new RegExp("</tr><tr>","g"),"\n"),e=e.replace(new RegExp(" ","g"),""),e=e.replace(new RegExp(",","g"),"\n"),e.replace(/<\/?[^>]+>/gi,"")};var r=t2.Screen.width-20;if(form=t2.Form.load(e,"main/store.form.js",{title:storeInfo.title,adr:prepareText(storeInfo.contacts.adr),phone:prepareText(storeInfo.contacts.phone),email:prepareText(storeInfo.contacts.email),mapWidth:r,mapHeight:r,storeBtnClick:function(){t2.Utils.info(storeInfo),t2.Utils.info(storeInfo.id),t2.Global.set("mainStoreID",storeInfo.id),t2.Global.set("mainStoreCity",storeInfo.contacts.city),cmp.createAlertDialog(storeInfo.contacts.city,"Склад успешно выбран!").show()},phoneClick:function(){var e=prepareText(storeInfo.contacts.phone).split("\n");e.push("Отмена");var t=Ti.UI.createOptionDialog({cancel:e.length-1,options:e,selectedIndex:e.length-1});t.addEventListener("click",function(t){t.index!==e.length-1&&(t2.Utils.info("call "+e[t.index]),Ti.Platform.openURL("tel:"+e[t.index]))}),t.show()},emailClick:function(){var e=Titanium.UI.createEmailDialog();e.toRecipients=[prepareText(storeInfo.contacts.email)],e.open()}}),storeInfo.location&&storeInfo.location.lat&&storeInfo.location.lon){var n=Map.createAnnotation({latitude:storeInfo.location.lon,longitude:storeInfo.location.lat,title:storeInfo.title,subtitle:prepareText(storeInfo.contacts.adr),animate:!0}),i=Map.createView({mapType:Map.STANDARD_TYPE,animate:!1,userLocation:!0,regionFit:!0,annotations:[n],top:10,bottom:20});form.map.add(i),i.setLocation({latitude:storeInfo.location.lon,longitude:storeInfo.location.lat,animate:!0,latitudeDelta:.01,longitudeDelta:.01}),i.selectAnnotation(n)}}function onWindowClose(e,t){}var t2,bank,cmp,win_main,form,mod,storeInfo,Map,cmp,clicked;module.exports={onInitController:onInitController,onWindowOpen:onWindowOpen,onWindowClose:onWindowClose};